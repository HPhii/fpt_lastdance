<mvc:View
    xmlns:simple="sap.gantt.simple"
    controllerName="z.wf.zwfmanagement.controller.MainView"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:l="sap.ui.layout"
    height="100%"
>
    <Page
        id="page"
        title="{i18n>title}"
        titleLevel="Auto"
        class="sapUiHeaderPadding"
        showFooter="{= !${worklistView>/detailVisible} }"
        enableScrolling="false"
        showNavButton="true"
        navButtonPress=".onNavBackToDashboard"
    >
        <headerContent>
            <core:Fragment
                fragmentName="z.wf.zwfmanagement.view.fragments.LanguageSelect"
                type="XML"
            />
        </headerContent>
        <IconTabBar
            id="iconTabBar"
            select=".onFilterStatus"
            expandable="false"
            stretchContentHeight="true"
            upperCase="true"
        >
            <items>
                <IconTabFilter
                    key="all"
                    showAll="true"
                    count="{/WfTasks/$count}"
                    text="{i18n>WorklistFilterTasksAll}"
                />
                <IconTabSeparator />
                <IconTabFilter
                    key="ready"
                    icon="sap-icon://task"
                    iconColor="Default"
                    count="{worklistView>/ready}"
                    text="{i18n>WorklistFilterTasksReady}"
                />
                <IconTabFilter
                    key="selected"
                    icon="sap-icon://employee-approvals"
                    iconColor="Neutral"
                    count="{worklistView>/selected}"
                    text="{i18n>WorklistFilterTasksSelected}"
                />
                <IconTabFilter
                    key="started"
                    icon="sap-icon://begin"
                    iconColor="Critical"
                    count="{worklistView>/started}"
                    text="{i18n>WorklistFilterTasksReady}"
                />
                <IconTabFilter
                    key="committed"
                    icon="sap-icon://org-chart"
                    iconColor="Critical"
                    count="{worklistView>/committed}"
                    text="{i18n>WorklistFilterTasksCommitted}"
                />
                <IconTabFilter
                    key="waiting"
                    icon="sap-icon://pending"
                    iconColor="Critical"
                    count="{worklistView>/waiting}"
                    text="{i18n>WorklistFilterTasksWaiting}"
                />
                <IconTabFilter
                    key="checked"
                    icon="sap-icon://inspection"
                    iconColor="Positive"
                    count="{worklistView>/checked}"
                    text="{i18n>WorklistFilterTasksChecked}"
                />
                <IconTabFilter
                    key="completed"
                    icon="sap-icon://complete"
                    iconColor="Positive"
                    count="{worklistView>/completed}"
                    text="{i18n>WorklistFilterTasksCompleted}"
                />
                <IconTabFilter
                    key="cancelled"
                    icon="sap-icon://decline"
                    iconColor="Negative"
                    count="{worklistView>/cancelled}"
                    text="{i18n>WorklistFilterTasksCancelled}"
                />
                <IconTabFilter
                    key="overdue"
                    icon="sap-icon://error"
                    iconColor="Negative"
                    count="{worklistView>/error}"
                    text="{i18n>WorklistFilterTasksError}"
                />
            </items>
            <content>
                <l:Splitter
                    id="mainSplitter"
                    orientation="Horizontal"
                    height="100%"
                >
                    <!-- Left Side: Task List -->
                    <l:contentAreas>
                        <VBox
                            width="100%"
                            height="100%"
                            class="leftPanel"
                        >
                            <layoutData>
                                <l:SplitterLayoutData
                                    size="{= ${worklistView>/detailVisible} ? '50%' : '100%' }"
                                    minSize="200"
                                />
                            </layoutData>
                            <ScrollContainer
                                height="100%"
                                width="100%"
                                vertical="true"
                                horizontal="false"
                            >
                                <layoutData>
                                    <FlexItemData
                                        growFactor="1"
                                        shrinkFactor="1"
                                        baseSize="0"
                                    />
                                </layoutData>
                                <List
                                    id="idTasksList"
                                    items="{ 
                                        path: '/WfTasks'
                                    }"
                                    mode="{worklistView>/listMode}"
                                    selectionChange=".onSelectionChange"
                                    growing="true"
                                    growingThreshold="20"
                                    noDataText="{i18n>tableNoDataText}"
                                >
                                    <headerToolbar>
                                        <Toolbar>
                                            <Title
                                                text="{i18n>tableHeaderTitle} {worklistView>/worklistTableTitle}"
                                                level="H2"
                                            />
                                            <ToolbarSpacer />
                                            <Button
                                                icon="sap-icon://sort"
                                                press=".onSort"
                                                tooltip="{i18n>tooltipHeaderSort}"
                                            />
                                            <Button
                                                icon="sap-icon://filter"
                                                press=".onFilter"
                                                tooltip="{i18n>tooltipHeaderFilter}"
                                            />
                                            <Button
                                                icon="sap-icon://group-2"
                                                press=".onGroup"
                                                tooltip="{i18n>tooltipHeaderGroup}"
                                            />
                                            <Button
                                                text="{i18n>tableHeaderSelectAll}"
                                                press=".onSelectAll"
                                                icon="sap-icon://multiselect-all"
                                                visible="{= ${worklistView>/listMode} === 'MultiSelect' }"
                                            />
                                            <Button
                                                text="{i18n>tableHeaderDeselectAll}"
                                                press=".onDeselectAll"
                                                icon="sap-icon://multiselect-none"
                                                visible="{= ${worklistView>/listMode} === 'MultiSelect' }"
                                            />
                                            <Button
                                                icon="sap-icon://multi-select"
                                                press=".onToggleMultiSelect"
                                                tooltip="Toggle Multi-Select Mode"
                                                type="{= ${worklistView>/listMode} === 'MultiSelect' ? 'Emphasized' : 'Default' }"
                                            />
                                            <SearchField
                                                width="auto"
                                                placeholder="{i18n>tableHeaderSearchPlaceholder}"
                                                search=".onSearch"
                                            />
                                        </Toolbar>
                                    </headerToolbar>
                                    <ObjectListItem
                                        title="{TaskText}"
                                        number="{AssignedUser}"
                                        type="Active"
                                        press=".onTaskPress"
                                    >
                                        <firstStatus>
                                            <ObjectStatus
                                                text="{PriorityText}"
                                                icon="sap-icon://{= ${Priority} === '1' ? 'alert' : 'information' }"
                                                state="{= ${Priority} === '1' ? 'Warning' : 'Information' }"
                                            />
                                        </firstStatus>
                                        <secondStatus>
                                            <ObjectStatus
                                                class="sapUiTextBold"
                                                text="{TechnicalStatus}"
                                                state="{
                                                    path: 'TechnicalStatus',
                                                    formatter: '.formatter.technicalStatusState'
                                                }"
                                            />
                                        </secondStatus>
                                        <ObjectAttribute
                                            text="{WorkItemID}"
                                            title="{i18n>columnTaskId}"
                                        />
                                        <ObjectAttribute
                                            text="{CreationDate}"
                                            title="{i18n>columnTaskCreationDate}"
                                        />
                                        <ObjectAttribute
                                            text="{= ${DaysToDeadline} > '1000' ? 'Infinity' : ${DaysToDeadline} }"
                                            title="{i18n>columnTaskDaysToDeadline}"
                                        />
                                    </ObjectListItem>
                                </List>
                            </ScrollContainer>
                        </VBox>
                    </l:contentAreas>
                    <!-- Right Side: Task Details -->
                    <l:contentAreas>
                        <ScrollContainer
                            id="detailContainer"
                            height="100%"
                            width="100%"
                            vertical="true"
                            horizontal="false"
                            visible="{worklistView>/detailVisible}"
                        >
                            <layoutData>
                                <l:SplitterLayoutData
                                    size="50%"
                                    minSize="300"
                                />
                            </layoutData>
                            <VBox
                                id="detailPanel"
                                class="sapUiSmallMargin"
                                busyIndicatorDelay="0"
                                busy="{worklistView>/detailBusy}"
                            >
                                <OverflowToolbar
                                    style="Clear"
                                    design="Transparent"
                                >
                                    <Button
                                        type="Neutral"
                                        icon="sap-icon://nav-back"
                                        press=".onCloseDetail"
                                    />
                                </OverflowToolbar>
                                <ObjectHeader
                                    intro="{TaskText}"
                                    title="{WorkItemText}"
                                    number="{Priority}"
                                    numberUnit="Priority"
                                >
                                    <attributes>
                                        <ObjectAttribute
                                            title="Work Item ID"
                                            text="{WorkItemID}"
                                        />
                                        <ObjectAttribute
                                            title="User ID"
                                            text="{AssignedUser}"
                                        />
                                        <ObjectAttribute
                                            title="Task ID"
                                            text="{TaskID}"
                                        />
                                        <ObjectAttribute
                                            title="Status"
                                            text="{TechnicalStatus}"
                                        />
                                        <ObjectAttribute
                                            title="{i18n>columnTaskCreationDate}"
                                            text="{CreationDate}"
                                        />
                                        <ObjectAttribute
                                            title="{i18n>columnTaskDaysToDeadline}"
                                            text="{= ${DaysToDeadline} > '1000' ? 'Infinity' : ${DaysToDeadline} }"
                                        />
                                    </attributes>
                                    <statuses>
                                        <ObjectStatus
                                            text="{PriorityText}"
                                            state="{= ${Priority} === '1' ? 'Warning' : 'Information' }"
                                        />
                                        <ObjectStatus
                                            text="{TechnicalStatus}"
                                            state="{
                                                path: 'TechnicalStatus',
                                                formatter: '.formatter.technicalStatusState'
                                            }"
                                        />
                                    </statuses>
                                </ObjectHeader>
                                <VBox class="sapUiSmallMargin">
                                    <Label
                                        text="{i18n>columnTaskDescription}"
                                        class="sapUiTinyMarginTop"
                                    />
                                    <Text
                                        text="{WorkItemText}"
                                        class="sapUiSmallMarginTop"
                                    />
                                </VBox>
                                <VBox class="sapUiSmallMargin">
                                    <Label text="Actions" />
                                    <HBox
                                        items="{_DecisionOptions}"
                                        class="sapUiSmallMarginTop"
                                    >
                                        <Button
                                            text="{DecisionText}"
                                            type="Emphasized"
                                            press=".onDecisionPress"
                                            class="sapUiTinyMarginEnd"
                                        >
                                            <customData>
                                                <core:CustomData
                                                    key="DecisionKey"
                                                    value="{DecisionKey}"
                                                />
                                                <core:CustomData
                                                    key="WorkItemID"
                                                    value="{WorkItemID}"
                                                />
                                            </customData>
                                        </Button>
                                    </HBox>
                                    <HBox class="sapUiSmallMarginTop">
                                        <Button
                                            text="{i18n>buttonApprove}"
                                            type="Success"
                                            icon="sap-icon://accept"
                                            press=".onApproveAction"
                                            visible="{__OperationControl/approve}"
                                            class="sapUiTinyMarginEnd"
                                        />
                                        <Button
                                            text="{i18n>buttonReject}"
                                            type="Negative"
                                            icon="sap-icon://decline"
                                            press=".onRejectAction"
                                            visible="{__OperationControl/reject}"
                                            class="sapUiTinyMarginEnd"
                                        />
                                        <Button
                                            text="{i18n>buttonClaim}"
                                            type="Emphasized"
                                            icon="sap-icon://user-edit"
                                            press=".onClaimAction"
                                            visible="{__OperationControl/claim}"
                                            class="sapUiTinyMarginEnd"
                                        />
                                        <Button
                                            text="{i18n>buttonForward}"
                                            type="Default"
                                            icon="sap-icon://forward"
                                            press=".onForwardAction"
                                            visible="{__OperationControl/forward}"
                                            class="sapUiTinyMarginEnd"
                                        />
                                        <Button
                                            text="{i18n>buttonRelease}"
                                            type="Transparent"
                                            icon="sap-icon://undo"
                                            press=".onReleaseAction"
                                            visible="{__OperationControl/release}"
                                            class="sapUiTinyMarginEnd"
                                        />
                                        <Button
                                            text="{i18n>buttonSuspend}"
                                            type="Reject"
                                            icon="sap-icon://pause"
                                            press=".onSuspendAction"
                                            visible="{__OperationControl/suspend}"
                                            class="sapUiTinyMarginEnd"
                                        />
                                    </HBox>
                                </VBox>
                            </VBox>
                        </ScrollContainer>
                    </l:contentAreas>
                </l:Splitter>
            </content>
        </IconTabBar>
        <footer>
            <OverflowToolbar id="otbFooter">
                <ToolbarSpacer />
                <Button
                    type="Default"
                    text="{i18n>buttonFooterDelegate}"
                >
                    <layoutData>
                        <OverflowToolbarLayoutData priority="NeverOverflow" />
                    </layoutData>
                </Button>
                <Button
                    type="Emphasized"
                    text="{i18n>buttonFooterSubtitute}"
                >
                    <layoutData>
                        <OverflowToolbarLayoutData priority="NeverOverflow" />
                    </layoutData>
                </Button>
                <OverflowToolbarButton
                    tooltip="Share"
                    text="Share"
                    icon="sap-icon://action"
                />
                <!-- <OverflowToolbarButton
                    tooltip="Edit"
                    text="Edit"
                    icon="sap-icon://edit"
                />
                <OverflowToolbarButton
                    tooltip="Add"
                    text="Add"
                    icon="sap-icon://add"
                />
                <OverflowToolbarButton
                    tooltip="Favorite"
                    text="Favorite"
                    icon="sap-icon://favorite"
                />
                <OverflowToolbarButton
                    tooltip="Flag"
                    text="Flag"
                    icon="sap-icon://flag"
                />
                <OverflowToolbarToggleButton
                    tooltip="Toggle"
                    text="Toggle"
                    icon="sap-icon://touch"
                    press="onTogglePress"
                /> -->
            </OverflowToolbar>
        </footer>
    </Page>
</mvc:View>
